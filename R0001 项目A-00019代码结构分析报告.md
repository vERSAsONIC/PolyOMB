# é¡¹ç›®Aï¼š00019ä»£ç ç»“æ„åˆ†ææŠ¥å‘Š

> ç ”ç©¶å‘˜è§’è‰²æ‰§è¡Œ | æ—¥æœŸï¼š2026-02-15

---

## ğŸ“ ç›®å½•ç»“æ„æ¦‚è§ˆ

```
CodeLib/00019/
â”œâ”€â”€ Polymarket Quantitative Trading/          # ä¸»é¡¹ç›®ç›®å½•
â”‚   â”œâ”€â”€ agents-main/                          # Python Agentæ¡†æ¶
â”‚   â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”‚   â”œâ”€â”€ polymarket/                   # Polymarketç›¸å…³
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ gamma.py                  # Gamma APIå®¢æˆ·ç«¯ â­æ ¸å¿ƒ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ polymarket.py             # Polymarketä¸»ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ objects.py                # æ•°æ®æ¨¡å‹å®šä¹‰ â­æ ¸å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ application/                  # åº”ç”¨å±‚
â”‚   â”‚   â”‚   â””â”€â”€ connectors/                   # è¿æ¥å™¨
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â””â”€â”€ docs/
â”‚   â”œâ”€â”€ debug_gamma_api.py                    # APIè°ƒè¯•è„šæœ¬ â­æ ¸å¿ƒ
â”‚   â”œâ”€â”€ debug_gamma_api_v2.py                 # APIè°ƒè¯•v2
â”‚   â”œâ”€â”€ fetch_high_conviction_events.py       # é«˜ä¿¡å¿µäº‹ä»¶æŠ“å–
â”‚   â”œâ”€â”€ fetch_politics_90_95.py              # æ”¿æ²»ç±»äº‹ä»¶æŠ“å–
â”‚   â”œâ”€â”€ get_active_markets.py                 # æ´»è·ƒå¸‚åœºè·å–
â”‚   â”œâ”€â”€ get_markets_order_status.py           # è®¢å•çŠ¶æ€æŸ¥è¯¢
â”‚   â”œâ”€â”€ gamma api.md                          # APIæ–‡æ¡£ â­æ ¸å¿ƒ
â”‚   â”œâ”€â”€ mermaid/                              # å›¾è¡¨æ–‡ä»¶
â”‚   â””â”€â”€ plans/                                # è®¡åˆ’æ–‡æ¡£
â””â”€â”€ ...
```

---

## ğŸ” æ ¸å¿ƒç»„ä»¶åˆ†æ

### 1. GammaMarketClient ç±» (`agents/polymarket/gamma.py`)

**å®šä½**ï¼šPolymarket Gamma API çš„ç»Ÿä¸€è®¿é—®å®¢æˆ·ç«¯

**æ ¸å¿ƒåŠŸèƒ½**ï¼š

| æ–¹æ³• | åŠŸèƒ½ | è¿”å›å€¼ |
|------|------|--------|
| `get_markets()` | é€šç”¨å¸‚åœºæŸ¥è¯¢ | List[Market] / JSON |
| `get_events()` | é€šç”¨äº‹ä»¶æŸ¥è¯¢ | List[PolymarketEvent] / JSON |
| `get_all_current_markets()` | è·å–æ‰€æœ‰æ´»è·ƒå¸‚åœºï¼ˆè‡ªåŠ¨åˆ†é¡µï¼‰ | List[Market] |
| `get_clob_tradable_markets()` | è·å–å¯CLOBäº¤æ˜“çš„å¸‚åœº | List[Market] |
| `parse_pydantic_market()` | è§£æå¸‚åœºæ•°æ®ä¸ºPydanticå¯¹è±¡ | Market |

**APIç«¯ç‚¹**ï¼š
```python
BASE_URL = "https://gamma-api.polymarket.com"
MARKETS_ENDPOINT = "/markets"
EVENTS_ENDPOINT = "/events"
```

**åˆ†é¡µæœºåˆ¶**ï¼š
```python
offset = 0
while True:
    params = {"limit": 100, "offset": offset, ...}
    batch = get_markets(params)
    if len(batch) < 100: break
    offset += 100
```

---

### 2. æ•°æ®æ¨¡å‹å®šä¹‰ (`agents/utils/objects.py`)

**ä½¿ç”¨ Pydantic è¿›è¡Œæ•°æ®éªŒè¯å’Œåºåˆ—åŒ–**

#### æ ¸å¿ƒæ¨¡å‹ï¼š

**Market ç±»**ï¼ˆä¸»è¦å­—æ®µï¼‰ï¼š
```python
class Market(BaseModel):
    id: int
    question: str                    # å¸‚åœºé—®é¢˜
    description: str                 # æè¿°
    active: bool                     # æ˜¯å¦æ´»è·ƒ
    closed: bool                     # æ˜¯å¦å…³é—­
    funded: bool
    outcomes: str                    # ç»“æœé€‰é¡¹ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
    outcome_prices: str             # ç»“æœä»·æ ¼ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
    clob_token_ids: Optional[str]   # CLOBä»£å¸ID
    spread: float
    volume: Optional[float]         # äº¤æ˜“é‡
    volume24hr: Optional[float]     # 24å°æ—¶äº¤æ˜“é‡
    liquidity: Optional[float]      # æµåŠ¨æ€§
    events: Optional[list[PolymarketEvent]]  # å…³è”äº‹ä»¶
    clobRewards: list[ClobReward]   # CLOBå¥–åŠ±
```

**PolymarketEvent ç±»**ï¼ˆä¸»è¦å­—æ®µï¼‰ï¼š
```python
class PolymarketEvent(BaseModel):
    id: str
    ticker: Optional[str]
    title: Optional[str]            # äº‹ä»¶æ ‡é¢˜
    startDate: Optional[str]        # å¼€å§‹æ—¥æœŸ
    endDate: Optional[str]          # ç»“æŸæ—¥æœŸ
    active: Optional[bool]
    closed: Optional[bool]
    volume: Optional[float]
    volume24hr: Optional[float]
    liquidity: Optional[float]
    tags: Optional[list[Tag]]       # æ ‡ç­¾ï¼ˆPoliticsç­‰ï¼‰
    markets: Optional[list[Market]] # å…³è”å¸‚åœº
```

**å…¶ä»–æ¨¡å‹**ï¼š
- `ClobReward`: CLOBå¥–åŠ±ä¿¡æ¯
- `Tag`: æ ‡ç­¾ï¼ˆid, label, slugï¼‰
- `Trade`: äº¤æ˜“è®°å½•

---

### 3. APIæ•°æ®ç»“æ„è°ƒè¯•è„šæœ¬ (`debug_gamma_api.py`)

**åŠŸèƒ½**ï¼šåˆ†æ Gamma API è¿”å›çš„çœŸå®æ•°æ®ç»“æ„

**å…³é”®å‘ç°**ï¼š

| å­—æ®µ | ä½ç½® | æ•°æ®ç±»å‹ | è¯´æ˜ |
|------|------|----------|------|
| `tags` | Market/Event | list[dict/str] | åˆ†ç±»æ ‡ç­¾ |
| `category` | Market | string | ç±»åˆ« |
| `tokens` | Market | list[dict] | ä»£å¸ä¿¡æ¯ï¼ˆå«price/outcomeï¼‰|
| `outcomePrices` | Market | string(JSON) | ç»“æœä»·æ ¼æ•°ç»„ |
| `events` | Market | list[dict] | å…³è”äº‹ä»¶ï¼ˆå«tagsï¼‰|
| `volume24hr` | Market/Event | float | 24å°æ—¶äº¤æ˜“é‡ |
| `liquidity` | Market/Event | float | æµåŠ¨æ€§ |

**å…³é”®å‚æ•°**ï¼š
```python
params = {
    "limit": 20,
    "active": "true",
    "closed": "false",
    "sort": "volume24hr",
    "ascending": "false",
    "populateEvents": "true"  # è·å–å…³è”Eventä¿¡æ¯
}
```

---

### 4. ä¸šåŠ¡é€»è¾‘è„šæœ¬åˆ†æ

#### `fetch_high_conviction_events.py`
- æŠ“å–é«˜ä¿¡å¿µåº¦äº‹ä»¶
- ç­›é€‰æ¡ä»¶ï¼šä»·æ ¼æ¥è¿‘0æˆ–1ï¼ˆç¡®å®šæ€§é«˜ï¼‰

#### `fetch_politics_90_95.py`
- æŠ“å–æ”¿æ²»ç±»äº‹ä»¶
- ç­›é€‰æ¡ä»¶ï¼šä»·æ ¼åœ¨0.9-0.95ä¹‹é—´

#### `get_active_markets.py`
- è·å–å½“å‰æ´»è·ƒå¸‚åœº
- åŸºç¡€æ•°æ®è·å–ç¤ºä¾‹

---

## ğŸ“Š æ•°æ®ç»“æ„å›¾è°±

```mermaid
erDiagram
    MARKET ||--o{ EVENT : contains
    MARKET ||--o{ TOKEN : has
    EVENT ||--o{ TAG : has
    
    MARKET {
        int id PK
        string question
        string description
        bool active
        bool closed
        string outcomes
        string outcomePrices
        float volume24hr
        float liquidity
    }
    
    EVENT {
        string id PK
        string title
        string startDate
        string endDate
        float volume24hr
        bool active
    }
    
    TOKEN {
        string token_id
        string outcome
        float price
    }
    
    TAG {
        string id
        string label
        string slug
    }
```

---

## âœ… å¯å¤ç”¨ç»„ä»¶æ¸…å•

### ç›´æ¥å¯ç”¨
| ç»„ä»¶ | æ–‡ä»¶ | ç”¨é€” |
|------|------|------|
| GammaMarketClient | gamma.py | APIå®¢æˆ·ç«¯æ ¸å¿ƒ |
| Marketæ¨¡å‹ | objects.py | å¸‚åœºæ•°æ®éªŒè¯ |
| PolymarketEventæ¨¡å‹ | objects.py | äº‹ä»¶æ•°æ®éªŒè¯ |
| åˆ†é¡µé€»è¾‘ | gamma.py:136 | å¤§æ•°æ®é‡è·å– |
| è°ƒè¯•è„šæœ¬ | debug_gamma_api.py | APIæµ‹è¯•æ¨¡æ¿ |

### éœ€é€‚é…æ”¹é€ 
| ç»„ä»¶ | æ”¹é€ ç‚¹ |
|------|--------|
| Pydanticæ¨¡å‹ | æ·»åŠ SQLAlchemyå…¼å®¹ |
| æœ¬åœ°æ–‡ä»¶å­˜å‚¨ | æ”¹ä¸ºæ•°æ®åº“å­˜å‚¨ |
| åŒæ­¥HTTP | æ”¹ä¸ºå¼‚æ­¥ï¼ˆhttpx/asyncï¼‰|

---

## âš ï¸ å·²çŸ¥é—®é¢˜

1. **APIå­—æ®µä¸ç¨³å®šæ€§**
   - éƒ¨åˆ†å­—æ®µå¯èƒ½ç¼ºå¤±ï¼ˆcreationDateç­‰ï¼‰
   - ä½¿ç”¨ `Optional[]` å¤„ç†

2. **JSONå­—ç¬¦ä¸²å­—æ®µ**
   - `outcomes`, `outcomePrices`, `clobTokenIds` ä¸ºJSONå­—ç¬¦ä¸²
   - éœ€è¦ `json.loads()` è§£æ

3. **Tagæ ¼å¼ä¸ä¸€è‡´**
   - æœ‰æ—¶æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæœ‰æ—¶æ˜¯å­—å…¸åˆ—è¡¨

---

## ğŸ¯ PolyOMBåº”ç”¨å»ºè®®

### æ¨¡å—1ï¼ˆæ•°æ®è·å–ï¼‰å¤ç”¨æ–¹æ¡ˆï¼š

```python
# å¤ç”¨ GammaMarketClientï¼Œæ”¹é€ ç‚¹ï¼š
1. æ·»åŠ æ•°æ®åº“å†™å…¥æ–¹æ³•
2. æ·»åŠ å¢é‡æ›´æ–°é€»è¾‘
3. æ·»åŠ å­—æ®µå˜æ›´æ£€æµ‹
4. æ·»åŠ å¼‚æ­¥æ”¯æŒ
```

### æ•°æ®åº“è®¾è®¡å‚è€ƒï¼š

åŸºäºç°æœ‰Pydanticæ¨¡å‹ï¼Œå¯ç›´æ¥è½¬æ¢ä¸ºSQLAlchemyæ¨¡å‹ï¼š
- `Market` â†’ `markets` è¡¨
- `PolymarketEvent` â†’ `events` è¡¨
- `Tag` â†’ `tags` è¡¨ + å…³è”è¡¨

---

## ğŸ“ ç›¸å…³æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ |
|------|------|
| Gamma APIå®¢æˆ·ç«¯ | `CodeLib/00019/Polymarket Quantitative Trading/agents-main/agents/polymarket/gamma.py` |
| æ•°æ®æ¨¡å‹ | `CodeLib/00019/Polymarket Quantitative Trading/agents-main/agents/utils/objects.py` |
| APIæ–‡æ¡£ | `CodeLib/00019/Polymarket Quantitative Trading/gamma api.md` |
| è°ƒè¯•è„šæœ¬ | `CodeLib/00019/Polymarket Quantitative Trading/debug_gamma_api.py` |

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š2026-02-15 | ç ”ç©¶å‘˜è§’è‰²*
