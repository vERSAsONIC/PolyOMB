# Phase 3 执行计划 - UI界面开发

> 严格遵循: 检查现有/补充测试 → 开发 → 测试 → 修改至100%通过

---

## 📋 执行概览

```
┌─────────────────────────────────────────────────────────────────┐
│  Phase 3: UI界面开发 (预计 4个任务 × 4步骤 = 16个阶段)         │
├─────────────────────────────────────────────────────────────────┤
│  每个任务执行顺序:                                               │
│  1️⃣ 检查现有/补充测试脚本 → 2️⃣ 开发 → 3️⃣ 测试 → 4️⃣ 修改至100%通过 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🎯 任务列表

| # | 任务 | 优先级 | 预计时间 | 技术栈 |
|---|------|--------|----------|--------|
| 1 | **Skill管理界面** | 🔴 高 | 1-2天 | Streamlit |
| 2 | **回试运行界面** | 🔴 高 | 2-3天 | Streamlit + Plotly |
| 3 | **结果图表展示** | 🟡 中 | 1-2天 | Plotly |
| 4 | **参数配置界面** | 🟡 中 | 1天 | Streamlit |

---

## 📁 计划新增文件

```
PolyOMB_Skills/00002_volatility_market_maker/
├── ui/                                    # 新增: UI模块目录
│   ├── __init__.py
│   ├── 00002_skill_manager.py            # 任务1: Skill管理
│   ├── 00002_backtest_runner.py          # 任务2: 回试运行
│   ├── 00002_result_charts.py            # 任务3: 结果图表
│   ├── 00002_param_config.py             # 任务4: 参数配置
│   └── app.py                             # 主入口
│
└── tests/
    ├── test_ui_skill_manager.py          # 任务1测试
    ├── test_ui_backtest_runner.py        # 任务2测试
    ├── test_ui_result_charts.py          # 任务3测试
    └── test_ui_param_config.py           # 任务4测试
```

---

## 📝 详细执行计划

### 任务1: Skill管理界面

#### 步骤1️⃣: 检查现有/补充测试脚本
- [ ] 检查现有 OpenClaw Skill 管理界面设计
- [ ] 确定界面组件清单
- [ ] 编写测试脚本 `test_ui_skill_manager.py`
  - 测试界面渲染
  - 测试Skill列表加载
  - 测试Skill选择

#### 步骤2️⃣: 开发
- [ ] 创建 `ui/00002_skill_manager.py`
- [ ] 实现 Skill 列表展示
- [ ] 实现 Skill 详情面板
- [ ] 实现 Skill 状态显示

#### 步骤3️⃣: 测试
```bash
python -m pytest tests/test_ui_skill_manager.py -v
```

#### 步骤4️⃣: 修改至100%通过
- [ ] 修复失败的测试
- [ ] 确保测试覆盖率 >80%
- [ ] 记录测试结果

---

### 任务2: 回试运行界面

#### 步骤1️⃣: 检查现有/补充测试脚本
- [ ] 分析架构规划中的三列布局设计 (20%-30%-50%)
- [ ] 确定筛选器组件清单
- [ ] 编写测试脚本 `test_ui_backtest_runner.py`
  - 测试筛选器面板
  - 测试Question列表
  - 测试结果面板

#### 步骤2️⃣: 开发
- [ ] 创建 `ui/00002_backtest_runner.py`
- [ ] 实现三列布局 (筛选器 | Question列表 | 结果)
- [ ] 实现筛选器面板 (数据源、市场类别、时间范围)
- [ ] 实现 Question 列表组件
- [ ] 实现结果展示面板

#### 步骤3️⃣: 测试
```bash
python -m pytest tests/test_ui_backtest_runner.py -v
```

#### 步骤4️⃣: 修改至100%通过
- [ ] 修复失败的测试
- [ ] 确保界面交互正常
- [ ] 记录测试结果

---

### 任务3: 结果图表展示

#### 步骤1️⃣: 检查现有/补充测试脚本
- [ ] 确定图表类型清单
  - 价格走势图
  - 买卖挂单深度图
  - 策略信号图
  - PnL曲线
- [ ] 编写测试脚本 `test_ui_result_charts.py`

#### 步骤2️⃣: 开发
- [ ] 创建 `ui/00002_result_charts.py`
- [ ] 实现价格走势图表
- [ ] 实现策略信号标记
- [ ] 实现 PnL 曲线
- [ ] 实现交易记录表格

#### 步骤3️⃣: 测试
```bash
python -m pytest tests/test_ui_result_charts.py -v
```

#### 步骤4️⃣: 修改至100%通过
- [ ] 修复失败的测试
- [ ] 确保图表渲染正确
- [ ] 记录测试结果

---

### 任务4: 参数配置界面

#### 步骤1️⃣: 检查现有/补充测试脚本
- [ ] 确定可配置参数清单
  - 止损阈值 (-5%)
  - 止盈阈值 (+3%)
  - 波动率阈值 (0.15)
  - 最大持仓 (250)
  - 交易数量 (50)
- [ ] 编写测试脚本 `test_ui_param_config.py`

#### 步骤2️⃣: 开发
- [ ] 创建 `ui/00002_param_config.py`
- [ ] 实现参数输入表单
- [ ] 实现参数验证
- [ ] 实现实时重算功能

#### 步骤3️⃣: 测试
```bash
python -m pytest tests/test_ui_param_config.py -v
```

#### 步骤4️⃣: 修改至100%通过
- [ ] 修复失败的测试
- [ ] 确保参数验证正确
- [ ] 记录测试结果

---

## ✅ 完成标准

每个任务必须满足:
- [ ] 测试覆盖率 ≥ 80%
- [ ] 所有测试通过 (100%)
- [ ] 代码审查通过
- [ ] 文档更新完成

---

## 📊 进度追踪

| 任务 | 步骤1 | 步骤2 | 步骤3 | 步骤4 | 状态 |
|------|-------|-------|-------|-------|------|
| 1. Skill管理界面 | ⬜ | ⬜ | ⬜ | ⬜ | 未开始 |
| 2. 回试运行界面 | ⬜ | ⬜ | ⬜ | ⬜ | 未开始 |
| 3. 结果图表展示 | ⬜ | ⬜ | ⬜ | ⬜ | 未开始 |
| 4. 参数配置界面 | ⬜ | ⬜ | ⬜ | ⬜ | 未开始 |

---

## 🚀 开始执行

### 当前状态
```
✅ V2 已commit: e3c9cf7 V2: 添加高效数据加载器 (MarketDataLoader)
✅ 测试状态: 124个测试100%通过
🎯 准备开始: Phase 3 - 任务1 - 步骤1 (检查现有/补充测试脚本)
```

### 下一步行动
请确认开始 **任务1: Skill管理界面** 的 **步骤1: 检查现有/补充测试脚本**

或者您想调整执行顺序/优先级？

---

**创建时间**: 2026-02-19  
**版本**: Phase 3 Plan v1.0
